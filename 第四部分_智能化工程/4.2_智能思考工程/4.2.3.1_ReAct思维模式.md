# 4.2.2.1 ReActæ€ç»´æ¨¡å¼ï¼šè¾¹æ€è€ƒè¾¹è¡ŒåŠ¨

> "ReActæ¨¡å¼æ¨¡æ‹Ÿäº†äººç±»è§£å†³å¤æ‚é—®é¢˜æ—¶çš„è‡ªç„¶æ€ç»´æ–¹å¼ï¼šé‡åˆ°é—®é¢˜åä¸æ˜¯ä¸€æ¬¡æ€§åˆ¶å®šå®Œæ•´è®¡åˆ’ï¼Œè€Œæ˜¯è¾¹æ€è€ƒè¾¹è¡ŒåŠ¨ï¼Œæ ¹æ®æ¯æ¬¡è¡ŒåŠ¨çš„ç»“æœè°ƒæ•´ä¸‹ä¸€æ­¥çš„ç­–ç•¥ã€‚"

## å­¦ä¹ ç›®æ ‡

- ç†è§£ReActï¼ˆæ¨ç†-è¡ŒåŠ¨ï¼‰æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³å’Œç†è®ºåŸºç¡€
- æŒæ¡å¾ªç¯å¼æ€ç»´çš„è®¾è®¡æ–¹æ³•å’Œå®ç°æŠ€æœ¯
- å­¦ä¼šæ„å»ºè‡ªé€‚åº”çš„æ™ºèƒ½å†³ç­–ç³»ç»Ÿ
- æŒæ¡ReActæ¨¡å¼åœ¨ä¸åŒåº”ç”¨åœºæ™¯ä¸­çš„ä¼˜åŒ–ç­–ç•¥

## ReActæ¨¡å¼çš„ç†è®ºåŸºç¡€

### è®¤çŸ¥ç§‘å­¦èƒŒæ™¯

ReActï¼ˆReasoning and Actingï¼‰æ¨¡å¼æºäºè®¤çŸ¥ç§‘å­¦å¯¹äººç±»é—®é¢˜è§£å†³è¿‡ç¨‹çš„ç ”ç©¶ã€‚ä¼ ç»Ÿçš„é—®é¢˜è§£å†³ç†è®ºå¾€å¾€å‡è®¾äººç±»ä¼šå…ˆåˆ¶å®šå®Œæ•´è®¡åˆ’å†æ‰§è¡Œï¼Œä½†å®é™…ç ”ç©¶è¡¨æ˜ï¼Œäººç±»åœ¨é¢å¯¹å¤æ‚æˆ–ä¸ç¡®å®šé—®é¢˜æ—¶ï¼Œæ›´å¤šé‡‡ç”¨çš„æ˜¯"æ¸è¿›å¼"è§£å†³ç­–ç•¥ï¼š

1. **æœ‰ç•Œç†æ€§**ï¼ˆBounded Rationalityï¼‰ï¼šäººç±»åœ¨ä¿¡æ¯æœ‰é™ã€æ—¶é—´æœ‰é™çš„æ¡ä»¶ä¸‹åšå‡º"æ»¡æ„"è€Œé"æœ€ä¼˜"çš„å†³ç­–
2. **æ¸è¿›ä¸»ä¹‰**ï¼ˆIncrementalismï¼‰ï¼šé€šè¿‡å°æ­¥éª¤çš„è¯•éªŒå’Œè°ƒæ•´æ¥é€æ­¥æ¥è¿‘ç›®æ ‡
3. **åæ€æ€§å®è·µ**ï¼ˆReflective Practiceï¼‰ï¼šåœ¨è¡ŒåŠ¨ä¸­æ€è€ƒï¼Œé€šè¿‡å®è·µè·å¾—æ´å¯Ÿ

### ReActçš„æ ¸å¿ƒç†å¿µ

ReActæ¨¡å¼å°†æ¨ç†ï¼ˆReasoningï¼‰å’Œè¡ŒåŠ¨ï¼ˆActingï¼‰ç´§å¯†ç»“åˆï¼Œå½¢æˆä¸€ä¸ªåŠ¨æ€çš„åé¦ˆå¾ªç¯ã€‚åœ¨ç°ä»£AIåº”ç”¨ä¸­ï¼ŒReActæ¨¡å¼ç‰¹åˆ«é€‚åˆåŸºäºLLMé©±åŠ¨çš„æ™ºèƒ½å†³ç­–ç³»ç»Ÿï¼Œå› ä¸ºLLMå¤©ç„¶å…·å¤‡å¼ºå¤§çš„æ¨ç†èƒ½åŠ›å’Œçµæ´»çš„é€‚åº”æ€§ï¼š

```
    æ€è€ƒ (Thought)
        â†“
    è¡ŒåŠ¨ (Action)  â† æŒç»­å¾ªç¯ç›´åˆ°é—®é¢˜è§£å†³
        â†“
    è§‚å¯Ÿ (Observation)
        â†‘
    â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç‰¹å¾**ï¼š
1. **äº¤æ›¿è¿›è¡Œ**ï¼šæ€è€ƒå’Œè¡ŒåŠ¨äº¤æ›¿è¿›è¡Œï¼Œä¸æ˜¯ä¸²è¡Œçš„ä¸¤ä¸ªé˜¶æ®µ
2. **å¢é‡å­¦ä¹ **ï¼šæ¯æ¬¡è¡ŒåŠ¨éƒ½ä¼šå¸¦æ¥æ–°ä¿¡æ¯ï¼Œç”¨äºæŒ‡å¯¼åç»­æ€è€ƒ
3. **è‡ªé€‚åº”è°ƒæ•´**ï¼šæ ¹æ®è§‚å¯Ÿç»“æœåŠ¨æ€è°ƒæ•´ç­–ç•¥å’Œç›®æ ‡
4. **å®¹é”™æœºåˆ¶**ï¼šå…è®¸è¯•é”™ï¼Œé€šè¿‡é”™è¯¯ä¸­å­¦ä¹ 

**LLMé©±åŠ¨çš„ReActä¼˜åŠ¿**ï¼š
- **ğŸ§  æ™ºèƒ½æ¨ç†**ï¼šLLMå¼ºå¤§çš„æ¨ç†èƒ½åŠ›ä½¿æ¯ä¸ª"æ€è€ƒ"æ­¥éª¤æ›´åŠ æ·±å…¥å’Œå‡†ç¡®
- **ğŸ¯ çµæ´»é€‚åº”**ï¼šLLMèƒ½å¤Ÿæ ¹æ®è§‚å¯Ÿç»“æœçµæ´»è°ƒæ•´æ€ç»´ç­–ç•¥
- **ğŸ’¡ åˆ›æ–°æ€ç»´**ï¼šLLMå¯ä»¥äº§ç”Ÿåˆ›æ–°æ€§çš„è¡ŒåŠ¨æ–¹æ¡ˆï¼Œè¶…è¶Šé¢„è®¾è§„åˆ™
- **ğŸ”„ æŒç»­ä¼˜åŒ–**ï¼šé€šè¿‡ä¸ç¯å¢ƒäº¤äº’ï¼ŒLLMä¸æ–­ä¼˜åŒ–å†³ç­–è´¨é‡

### ä¸å…¶ä»–æ€ç»´æ¨¡å¼çš„å¯¹æ¯”

| ç‰¹å¾ | ReActæ¨¡å¼ | ä¼ ç»Ÿè§„åˆ’æ¨¡å¼ | å¯å‘å¼æœç´¢ |
|------|-----------|-------------|-----------|
| è§„åˆ’ç²’åº¦ | ç»†ç²’åº¦ï¼Œæ­¥æ­¥è§„åˆ’ | ç²—ç²’åº¦ï¼Œé¢„å…ˆè§„åˆ’ | ä¸­ç­‰ç²’åº¦ |
| é€‚åº”æ€§ | é«˜ï¼ŒåŠ¨æ€è°ƒæ•´ | ä½ï¼Œé¢„è®¾è·¯å¾„ | ä¸­ç­‰ |
| ä¿¡æ¯éœ€æ±‚ | æ¸è¿›è·å– | éœ€è¦å®Œæ•´ä¿¡æ¯ | éƒ¨åˆ†ä¿¡æ¯ |
| å®¹é”™èƒ½åŠ› | å¼ºï¼Œæ”¯æŒè¯•é”™ | å¼±ï¼Œè®¡åˆ’åå·®å½±å“å¤§ | ä¸­ç­‰ |
| è®¡ç®—å¼€é”€ | ä¸­ç­‰ï¼Œåˆ†å¸ƒå¼è®¡ç®— | é«˜ï¼Œå‰æœŸè®¡ç®—å¯†é›† | é«˜ï¼Œæœç´¢å¼€é”€å¤§ |

## ReActå·¥ä½œæµç¨‹è®¾è®¡

### åŸºæœ¬å·¥ä½œæµç¨‹

```
åˆå§‹çŠ¶æ€ â†’ ç†è§£é—®é¢˜
    â†“
[å¾ªç¯å¼€å§‹]
    â†“
1. æ€è€ƒé˜¶æ®µ (Think)
   - åˆ†æå½“å‰çŠ¶æ€
   - ç¡®å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨
   - è¯„ä¼°è¡ŒåŠ¨é€‰é¡¹
    â†“
2. è¡ŒåŠ¨é˜¶æ®µ (Act)  
   - æ‰§è¡Œå…·ä½“æ“ä½œ
   - è°ƒç”¨å·¥å…·/API
   - æ”¶é›†æ‰§è¡Œç»“æœ
    â†“
3. è§‚å¯Ÿé˜¶æ®µ (Observe)
   - åˆ†æè¡ŒåŠ¨ç»“æœ
   - æ›´æ–°çŠ¶æ€ç†è§£
   - åˆ¤æ–­æ˜¯å¦è¾¾æˆç›®æ ‡
    â†“
[ç›®æ ‡è¾¾æˆ?] â†’ No: å¾ªç¯ç»§ç»­
    â†“ Yes
ç»ˆæ­¢æ¡ä»¶æ»¡è¶³
    â†“
è¾“å‡ºæœ€ç»ˆç»“æœ
```

### å®ç°æ¶æ„è®¾è®¡

åŸºäºjoyagent-jdgenieé¡¹ç›®çš„å®ç°åˆ†æï¼ŒReActæ¨¡å¼çš„æ ¸å¿ƒæ¶æ„åŒ…æ‹¬ï¼š

```java
/**
 * ReActä»£ç†çš„æŠ½è±¡åŸºç±»
 */
public abstract class ReActAgent extends BaseAgent {
    
    /**
     * æ€è€ƒé˜¶æ®µï¼šåˆ†æå½“å‰çŠ¶æ€ï¼Œç¡®å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨
     * @return æ˜¯å¦éœ€è¦æ‰§è¡Œè¡ŒåŠ¨
     */
    public abstract boolean think();
    
    /**
     * è¡ŒåŠ¨é˜¶æ®µï¼šæ‰§è¡Œå…·ä½“æ“ä½œ
     * @return æ‰§è¡Œç»“æœ
     */
    public abstract String act();
    
    /**
     * ReActå¾ªç¯çš„æ ¸å¿ƒå®ç°
     */
    @Override
    public String step() {
        // æ€è€ƒï¼šç¡®å®šæ˜¯å¦éœ€è¦è¡ŒåŠ¨
        boolean shouldAct = think();
        
        if (!shouldAct) {
            // æ€è€ƒå®Œæˆï¼Œæ— éœ€è¿›ä¸€æ­¥è¡ŒåŠ¨
            setState(AgentState.FINISHED);
            return "Thinking complete - no action needed";
        }
        
        // è¡ŒåŠ¨ï¼šæ‰§è¡Œå…·ä½“æ“ä½œ
        return act();
    }
}
```

### è¯¦ç»†å®ç°è§£æ

#### 1. æ€è€ƒé˜¶æ®µï¼ˆThink Phaseï¼‰

**åŠŸèƒ½èŒè´£**ï¼š
- åˆ†æå½“å‰ä»»åŠ¡çŠ¶æ€å’Œä¸Šä¸‹æ–‡ä¿¡æ¯
- è¯„ä¼°å¯ç”¨çš„è¡ŒåŠ¨é€‰é¡¹
- é€‰æ‹©æœ€ä¼˜çš„ä¸‹ä¸€æ­¥è¡ŒåŠ¨
- å†³å®šæ˜¯å¦éœ€è¦æ‰§è¡Œè¡ŒåŠ¨

**æ ¸å¿ƒå®ç°**ï¼š
```java
@Override
public boolean think() {
    // è·å–ä¸Šä¸‹æ–‡ä¿¡æ¯
    String filesStr = FileUtil.formatFileInfo(context.getProductFiles(), true);
    String systemPrompt = getSystemPromptSnapshot().replace("{{files}}", filesStr);
    String nextStepPrompt = getNextStepPromptSnapshot().replace("{{files}}", filesStr);
    
    // æ„å»ºæ€è€ƒä¸Šä¸‹æ–‡
    List<Message> messages = getMemory().getMessages();
    if (!getMemory().getLastMessage().getRole().equals(RoleType.USER)) {
        Message userMsg = Message.userMessage(nextStepPrompt, null);
        getMemory().addMessage(userMsg);
    }
    
    try {
        // è°ƒç”¨LLMè¿›è¡Œæ€è€ƒ
        context.setStreamMessageType("tool_thought");
        CompletableFuture<LLM.ToolCallResponse> future = getLlm().askTool(
            context,
            messages,
            Message.systemMessage(systemPrompt, null),
            availableTools,
            ToolChoice.AUTO, 
            null, 
            context.getIsStream(), 
            300
        );
        
        LLM.ToolCallResponse response = future.get();
        setToolCalls(response.getToolCalls());
        
        // è®°å½•æ€è€ƒç»“æœ
        Message assistantMsg = response.getToolCalls() != null && !response.getToolCalls().isEmpty() ?
            Message.fromToolCalls(response.getContent(), response.getToolCalls()) :
            Message.assistantMessage(response.getContent(), null);
        getMemory().addMessage(assistantMsg);
        
        // åˆ¤æ–­æ˜¯å¦éœ€è¦è¡ŒåŠ¨
        return response.getToolCalls() != null && !response.getToolCalls().isEmpty();
        
    } catch (Exception e) {
        log.error("Thinking failed", e);
        return false;
    }
}
```

**æ€è€ƒè´¨é‡çš„è¯„ä¼°æŒ‡æ ‡**ï¼š
- **ç›¸å…³æ€§**ï¼šæ€è€ƒå†…å®¹ä¸å½“å‰ä»»åŠ¡çš„ç›¸å…³ç¨‹åº¦
- **é€»è¾‘æ€§**ï¼šæ¨ç†é“¾æ¡çš„é€»è¾‘å®Œæ•´æ€§
- **åˆ›æ–°æ€§**ï¼šæ˜¯å¦äº§ç”Ÿæ–°çš„è§£å†³æ€è·¯
- **æ•ˆç‡æ€§**ï¼šæ€è€ƒæ—¶é—´ä¸è´¨é‡çš„å¹³è¡¡

#### 2. è¡ŒåŠ¨é˜¶æ®µï¼ˆAct Phaseï¼‰

**åŠŸèƒ½èŒè´£**ï¼š
- æ‰§è¡Œæ€è€ƒé˜¶æ®µç¡®å®šçš„è¡ŒåŠ¨
- è°ƒç”¨ç›¸åº”çš„å·¥å…·å’ŒAPI
- å¤„ç†æ‰§è¡Œç»“æœå’Œå¼‚å¸¸
- æ›´æ–°ç³»ç»ŸçŠ¶æ€

**å®ç°ç­–ç•¥**ï¼š
```java
@Override
public String act() {
    List<String> results = new ArrayList<>();
    
    // æ‰§è¡Œæ‰€æœ‰è®¡åˆ’çš„å·¥å…·è°ƒç”¨
    for (ToolCall toolCall : toolCalls) {
        try {
            // æ‰§è¡Œå•ä¸ªå·¥å…·
            String result = executeTool(toolCall);
            
            // ç»“æœé•¿åº¦æ§åˆ¶ï¼ˆé¿å…ä¿¡æ¯è¿‡è½½ï¼‰
            if (maxObserve != null) {
                result = result.substring(0, Math.min(result.length(), maxObserve));
            }
            
            results.add(result);
            
            // æ›´æ–°è®°å¿†ï¼šæ·»åŠ å·¥å…·æ‰§è¡Œç»“æœ
            updateMemoryWithToolResult(toolCall, result);
            
            // å®æ—¶åé¦ˆæ‰§è¡Œè¿›åº¦
            notifyProgress(toolCall, result);
            
        } catch (Exception e) {
            // é”™è¯¯å¤„ç†å’Œæ¢å¤
            String errorResult = handleExecutionError(toolCall, e);
            results.add(errorResult);
        }
    }
    
    return String.join("\n\n", results);
}

private void updateMemoryWithToolResult(ToolCall toolCall, String result) {
    if ("struct_parse".equals(llm.getFunctionCallType())) {
        // ç»“æ„åŒ–è§£ææ¨¡å¼ï¼šè¿½åŠ åˆ°æœ€åä¸€æ¡æ¶ˆæ¯
        String content = getMemory().getLastMessage().getContent();
        getMemory().getLastMessage().setContent(content + "\nå·¥å…·æ‰§è¡Œç»“æœ:\n" + result);
    } else {
        // å‡½æ•°è°ƒç”¨æ¨¡å¼ï¼šæ·»åŠ ç‹¬ç«‹çš„å·¥å…·æ¶ˆæ¯
        Message toolMsg = Message.toolMessage(result, toolCall.getId(), null);
        getMemory().addMessage(toolMsg);
    }
}
```

#### 3. è§‚å¯Ÿé˜¶æ®µï¼ˆObserve Phaseï¼‰

è§‚å¯Ÿé˜¶æ®µå†…åµŒåœ¨è¡ŒåŠ¨é˜¶æ®µçš„ç»“æœå¤„ç†ä¸­ï¼š

**è§‚å¯Ÿç»´åº¦**ï¼š
- **ç»“æœæ­£ç¡®æ€§**ï¼šæ‰§è¡Œç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸ
- **ä¿¡æ¯å®Œæ•´æ€§**ï¼šæ˜¯å¦è·å¾—äº†è¶³å¤Ÿçš„ä¿¡æ¯ç»§ç»­æ¨è¿›
- **ç›®æ ‡æ¥è¿‘åº¦**ï¼šå½“å‰çŠ¶æ€ä¸æœ€ç»ˆç›®æ ‡çš„è·ç¦»
- **å¼‚å¸¸æ£€æµ‹**ï¼šæ˜¯å¦å‡ºç°éœ€è¦ç‰¹æ®Šå¤„ç†çš„æƒ…å†µ

```java
private String observeAndAnalyze(String actionResult) {
    // ç»“æœè´¨é‡è¯„ä¼°
    ResultQuality quality = assessResultQuality(actionResult);
    
    // ç›®æ ‡è¾¾æˆåº¦æ£€æŸ¥
    double goalProgress = calculateGoalProgress(actionResult);
    
    // å¼‚å¸¸æ¨¡å¼æ£€æµ‹
    List<String> anomalies = detectAnomalies(actionResult);
    
    // ç”Ÿæˆè§‚å¯ŸæŠ¥å‘Š
    ObservationReport report = ObservationReport.builder()
        .quality(quality)
        .progress(goalProgress)
        .anomalies(anomalies)
        .nextStepSuggestions(generateNextStepSuggestions())
        .build();
    
    return formatObservationReport(report);
}
```

## ReActæ¨¡å¼çš„é€‚ç”¨åœºæ™¯

### 1. ä¿¡æ¯è·å–å‹ä»»åŠ¡

**ç‰¹å¾**ï¼šéœ€è¦é€šè¿‡å¤šæ¬¡æœç´¢å’ŒæŸ¥è¯¢æ¥æ”¶é›†ä¿¡æ¯

**å…¸å‹åœºæ™¯**ï¼š
- ç ”ç©¶æ€§é—®é¢˜å›ç­”
- å¸‚åœºè°ƒç ”å’Œåˆ†æ
- æŠ€æœ¯æ–‡æ¡£æ•´ç†
- å­¦æœ¯èµ„æ–™æ”¶é›†

**ä¼˜åŠ¿åˆ†æ**ï¼š
- å¯ä»¥æ ¹æ®åˆæ­¥æœç´¢ç»“æœè°ƒæ•´æœç´¢ç­–ç•¥
- é¿å…ä¿¡æ¯è¿‡è½½ï¼Œé€æ­¥èšç„¦ç›¸å…³å†…å®¹
- æ”¯æŒå¤šæºä¿¡æ¯çš„äº¤å‰éªŒè¯

**å®ç°ç¤ºä¾‹**ï¼š
```java
public class ResearchAgent extends ReActAgent {
    
    @Override
    public boolean think() {
        // åˆ†æå½“å‰å·²æ”¶é›†çš„ä¿¡æ¯
        List<String> collectedInfo = analyzeCollectedInformation();
        
        // è¯†åˆ«ä¿¡æ¯ç¼ºå£
        List<String> informationGaps = identifyInformationGaps(collectedInfo);
        
        if (informationGaps.isEmpty()) {
            // ä¿¡æ¯æ”¶é›†å®Œæˆ
            return false;
        }
        
        // åˆ¶å®šä¸‹ä¸€æ­¥æœç´¢ç­–ç•¥
        String nextSearchQuery = formulateSearchQuery(informationGaps.get(0));
        setNextAction("search", nextSearchQuery);
        
        return true;
    }
    
    @Override
    public String act() {
        // æ‰§è¡Œæœç´¢æ“ä½œ
        String searchResult = executeSearch(getNextAction());
        
        // åˆ†ææœç´¢ç»“æœè´¨é‡
        SearchQuality quality = assessSearchQuality(searchResult);
        
        if (quality.isHighQuality()) {
            // é«˜è´¨é‡ç»“æœï¼šæ•´åˆåˆ°çŸ¥è¯†åº“
            integrateInformation(searchResult);
        } else {
            // ä½è´¨é‡ç»“æœï¼šè°ƒæ•´æœç´¢ç­–ç•¥
            adjustSearchStrategy(quality.getDeficiencies());
        }
        
        return formatSearchResult(searchResult, quality);
    }
}
```

### 2. æ¢ç´¢å¼é—®é¢˜è§£å†³

**ç‰¹å¾**ï¼šé—®é¢˜çš„è§£å†³è·¯å¾„ä¸æ˜ç¡®ï¼Œéœ€è¦é€æ­¥æ¢ç´¢

**å…¸å‹åœºæ™¯**ï¼š
- æ•…éšœè¯Šæ–­å’Œæ’æŸ¥
- åˆ›æ–°æ–¹æ¡ˆè®¾è®¡
- å¤æ‚ç³»ç»Ÿåˆ†æ
- æœªçŸ¥é¢†åŸŸæ¢ç´¢

**è®¾è®¡è€ƒè™‘**ï¼š
```java
public class ExplorationAgent extends ReActAgent {
    private Set<String> exploredPaths = new HashSet<>();
    private Stack<String> explorationHistory = new Stack<>();
    
    @Override
    public boolean think() {
        // è¯„ä¼°å½“å‰æ¢ç´¢çŠ¶æ€
        ExplorationState state = assessExplorationState();
        
        if (state.isDeadEnd()) {
            // æ­»èƒ¡åŒï¼šå›æº¯åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯ç‚¹
            backtrackToPreviousBranch();
            return true;
        }
        
        if (state.hasUnexploredOptions()) {
            // é€‰æ‹©ä¸‹ä¸€ä¸ªæ¢ç´¢æ–¹å‘
            String nextDirection = selectNextExplorationDirection(state);
            setNextAction("explore", nextDirection);
            return true;
        }
        
        // æ¢ç´¢å®Œæˆæˆ–æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ
        return false;
    }
    
    private void backtrackToPreviousBranch() {
        while (!explorationHistory.isEmpty()) {
            String previousState = explorationHistory.pop();
            if (hasUnexploredOptions(previousState)) {
                restoreToState(previousState);
                break;
            }
        }
    }
}
```

### 3. äº¤äº’å¼ä»»åŠ¡å¤„ç†

**ç‰¹å¾**ï¼šéœ€è¦æ ¹æ®ç”¨æˆ·åé¦ˆåŠ¨æ€è°ƒæ•´ç­–ç•¥

**å®ç°æ¡†æ¶**ï¼š
```java
public class InteractiveAgent extends ReActAgent {
    private UserFeedbackProcessor feedbackProcessor;
    
    @Override
    public boolean think() {
        // æ£€æŸ¥æ˜¯å¦æœ‰ç”¨æˆ·åé¦ˆ
        Optional<UserFeedback> feedback = checkForUserFeedback();
        
        if (feedback.isPresent()) {
            // æ ¹æ®åé¦ˆè°ƒæ•´ç­–ç•¥
            adjustStrategyBasedOnFeedback(feedback.get());
        }
        
        // ç¡®å®šä¸‹ä¸€æ­¥äº¤äº’å†…å®¹
        InteractionPlan plan = planNextInteraction();
        setNextAction("interact", plan);
        
        return plan.requiresAction();
    }
    
    @Override
    public String act() {
        InteractionPlan plan = getCurrentInteractionPlan();
        
        switch (plan.getType()) {
            case QUESTION:
                return askUserQuestion(plan.getContent());
            case CLARIFICATION:
                return requestClarification(plan.getContent());
            case PROPOSAL:
                return presentProposal(plan.getContent());
            default:
                return executeStandardAction(plan);
        }
    }
}
```

## ReActæ¨¡å¼çš„ä¼˜åŒ–ç­–ç•¥

### 1. æ€è€ƒæ·±åº¦æ§åˆ¶

**é—®é¢˜**ï¼šè¿‡åº¦æ€è€ƒå¯¼è‡´è¡ŒåŠ¨è¿Ÿç¼“

**è§£å†³æ–¹æ¡ˆ**ï¼š
```java
public class ThinkingDepthController {
    private final int maxThinkingTime = 30; // ç§’
    private final int maxThinkingIterations = 5;
    
    public boolean shouldStopThinking(long startTime, int iterations) {
        // æ—¶é—´é™åˆ¶
        if (System.currentTimeMillis() - startTime > maxThinkingTime * 1000) {
            return true;
        }
        
        // è¿­ä»£æ¬¡æ•°é™åˆ¶
        if (iterations >= maxThinkingIterations) {
            return true;
        }
        
        // æ€è€ƒè´¨é‡è¯„ä¼°
        return hasReachedSatisfactoryThinkingQuality();
    }
    
    private boolean hasReachedSatisfactoryThinkingQuality() {
        // è¯„ä¼°æ€è€ƒç»“æœçš„æ¸…æ™°åº¦å’Œå¯æ‰§è¡Œæ€§
        // è¿”å›trueè¡¨ç¤ºå½“å‰æ€è€ƒè´¨é‡å·²è¶³å¤ŸæŒ‡å¯¼è¡ŒåŠ¨
        return getCurrentThinkingQuality().isSatisfactory();
    }
}
```

### 2. è¡ŒåŠ¨æ•ˆæœè¯„ä¼°

**è¯„ä¼°ç»´åº¦**ï¼š
- **æœ‰æ•ˆæ€§**ï¼šè¡ŒåŠ¨æ˜¯å¦äº§ç”Ÿé¢„æœŸæ•ˆæœ
- **æ•ˆç‡æ€§**ï¼šè¡ŒåŠ¨çš„æ—¶é—´å’Œèµ„æºæ¶ˆè€—
- **å‰¯ä½œç”¨**ï¼šè¡ŒåŠ¨æ˜¯å¦äº§ç”Ÿæ„å¤–å½±å“

```java
public class ActionEffectivenessEvaluator {
    
    public ActionEvaluation evaluateAction(ToolCall action, String result) {
        return ActionEvaluation.builder()
            .effectiveness(calculateEffectiveness(action, result))
            .efficiency(calculateEfficiency(action))
            .sideEffects(analyzeSideEffects(result))
            .learnings(extractLearnings(action, result))
            .recommendations(generateRecommendations(action, result))
            .build();
    }
    
    private double calculateEffectiveness(ToolCall action, String result) {
        // æ¯”è¾ƒé¢„æœŸç»“æœä¸å®é™…ç»“æœ
        String expectedResult = action.getExpectedOutcome();
        return semanticSimilarity(expectedResult, result);
    }
    
    private List<String> extractLearnings(ToolCall action, String result) {
        List<String> learnings = new ArrayList<>();
        
        // æˆåŠŸæ¨¡å¼å­¦ä¹ 
        if (isSuccessfulAction(action, result)) {
            learnings.add("Successful pattern: " + action.getPattern());
        }
        
        // å¤±è´¥æ¨¡å¼å­¦ä¹ 
        if (isFailedAction(action, result)) {
            learnings.add("Failed pattern to avoid: " + action.getPattern());
        }
        
        return learnings;
    }
}
```

### 3. å¾ªç¯ç»ˆæ­¢æ¡ä»¶ä¼˜åŒ–

**å¤šå±‚æ¬¡ç»ˆæ­¢æ¡ä»¶**ï¼š
```java
public class TerminationConditionManager {
    
    public boolean shouldTerminate(ReActContext context) {
        // 1. ç›®æ ‡è¾¾æˆæ£€æŸ¥
        if (isGoalAchieved(context)) {
            return true;
        }
        
        // 2. èµ„æºè€—å°½æ£€æŸ¥
        if (isResourceExhausted(context)) {
            return true;
        }
        
        // 3. å¾ªç¯æ£€æµ‹
        if (isStuckInLoop(context)) {
            return true;
        }
        
        // 4. è´¨é‡ä¸‹é™æ£€æŸ¥
        if (isQualityDeteriorating(context)) {
            return true;
        }
        
        // 5. ç”¨æˆ·ä¸­æ–­æ£€æŸ¥
        if (isUserInterrupted(context)) {
            return true;
        }
        
        return false;
    }
    
    private boolean isStuckInLoop(ReActContext context) {
        List<String> recentActions = context.getRecentActions(5);
        return hasCyclicalPattern(recentActions);
    }
}
```

## æ€§èƒ½ä¼˜åŒ–ä¸å·¥ç¨‹å®è·µ

### 1. å¹¶è¡Œæ€è€ƒæœºåˆ¶

**å¤šè§’åº¦å¹¶è¡Œæ€è€ƒ**ï¼š
```java
public class ParallelThinkingEngine {
    private final ExecutorService thinkingPool;
    
    public CompletableFuture<ThinkingResult> parallelThink(Problem problem) {
        List<CompletableFuture<ThinkingPerspective>> futures = Arrays.asList(
            // é€»è¾‘æ¨ç†è§’åº¦
            CompletableFuture.supplyAsync(() -> logicalReasoning(problem), thinkingPool),
            // åˆ›æ–°æ€ç»´è§’åº¦
            CompletableFuture.supplyAsync(() -> creativeThinking(problem), thinkingPool),
            // ç»éªŒå€Ÿé‰´è§’åº¦
            CompletableFuture.supplyAsync(() -> experienceBasedThinking(problem), thinkingPool)
        );
        
        return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))
            .thenApply(v -> {
                List<ThinkingPerspective> perspectives = futures.stream()
                    .map(CompletableFuture::join)
                    .collect(Collectors.toList());
                return synthesizeThinkingResults(perspectives);
            });
    }
}
```

### 2. è‡ªé€‚åº”æ­¥é•¿è°ƒæ•´

**åŠ¨æ€è°ƒæ•´æ€ç»´-è¡ŒåŠ¨çš„é¢‘ç‡**ï¼š
```java
public class AdaptiveStepController {
    private double currentStepSize = 1.0;
    private final double minStepSize = 0.1;
    private final double maxStepSize = 2.0;
    
    public void adjustStepSize(ActionResult lastResult) {
        if (lastResult.isHighQuality()) {
            // ç»“æœè´¨é‡é«˜ï¼šå¢å¤§æ­¥é•¿ï¼Œå‡å°‘æ€è€ƒé¢‘ç‡
            currentStepSize = Math.min(maxStepSize, currentStepSize * 1.2);
        } else if (lastResult.isLowQuality()) {
            // ç»“æœè´¨é‡ä½ï¼šå‡å°æ­¥é•¿ï¼Œå¢åŠ æ€è€ƒé¢‘ç‡
            currentStepSize = Math.max(minStepSize, currentStepSize * 0.8);
        }
    }
    
    public boolean shouldThinkBeforeNextAction() {
        return Math.random() < (1.0 / currentStepSize);
    }
}
```

### 3. è®°å¿†ç®¡ç†ä¼˜åŒ–

**æ™ºèƒ½è®°å¿†å‹ç¼©**ï¼š
```java
public class IntelligentMemoryManager {
    private final int maxMemorySize = 50;
    private final MemoryCompressor compressor;
    
    public void compressMemoryIfNeeded(Memory memory) {
        if (memory.size() > maxMemorySize) {
            // è¯†åˆ«é‡è¦è®°å¿†
            List<Message> importantMessages = identifyImportantMemories(memory);
            
            // å‹ç¼©éé‡è¦è®°å¿†
            List<Message> compressedMessages = compressor.compress(
                memory.getNonImportantMessages()
            );
            
            // é‡å»ºè®°å¿†
            memory.clear();
            memory.addAll(importantMessages);
            memory.addAll(compressedMessages);
        }
    }
    
    private List<Message> identifyImportantMemories(Memory memory) {
        return memory.getMessages().stream()
            .filter(this::isImportantMessage)
            .collect(Collectors.toList());
    }
    
    private boolean isImportantMessage(Message message) {
        return message.hasHighRelevanceScore() || 
               message.containsBreakthroughInformation() ||
               message.isRecentlyAccessed();
    }
}
```

## è°ƒè¯•ä¸ç›‘æ§

### 1. æ€ç»´è¿‡ç¨‹å¯è§†åŒ–

```java
public class ReActTracer {
    private final List<ThinkingStep> trace = new ArrayList<>();
    
    public void recordThinkingStep(String thought, List<String> considerations) {
        trace.add(ThinkingStep.builder()
            .type("THINKING")
            .content(thought)
            .metadata(Map.of("considerations", considerations))
            .timestamp(System.currentTimeMillis())
            .build());
    }
    
    public void recordActionStep(ToolCall action, String result) {
        trace.add(ThinkingStep.builder()
            .type("ACTION")
            .content(action.toString())
            .metadata(Map.of("result", result))
            .timestamp(System.currentTimeMillis())
            .build());
    }
    
    public ThinkingTrace generateTrace() {
        return ThinkingTrace.builder()
            .steps(trace)
            .totalThinkingTime(calculateThinkingTime())
            .totalActionTime(calculateActionTime())
            .thinkingActionRatio(calculateThinkingActionRatio())
            .build();
    }
}
```

### 2. æ€§èƒ½æŒ‡æ ‡ç›‘æ§

```java
@Component
public class ReActMetrics {
    
    @EventListener
    public void onThinkingCompleted(ThinkingCompletedEvent event) {
        // è®°å½•æ€è€ƒæ—¶é—´
        meterRegistry.timer("react.thinking.duration")
            .record(event.getDuration(), TimeUnit.MILLISECONDS);
        
        // è®°å½•æ€è€ƒè´¨é‡
        meterRegistry.gauge("react.thinking.quality", event.getQualityScore());
    }
    
    @EventListener
    public void onActionCompleted(ActionCompletedEvent event) {
        // è®°å½•è¡ŒåŠ¨æˆåŠŸç‡
        meterRegistry.counter("react.action.completed", 
            "success", String.valueOf(event.isSuccessful()))
            .increment();
        
        // è®°å½•è¡ŒåŠ¨æ•ˆæœ
        meterRegistry.gauge("react.action.effectiveness", event.getEffectiveness());
    }
}
```

## å°ç»“

ReActæ€ç»´æ¨¡å¼é€šè¿‡å°†æ¨ç†å’Œè¡ŒåŠ¨ç´§å¯†ç»“åˆï¼Œä¸ºAIç³»ç»Ÿæä¾›äº†ä¸€ç§è‡ªç„¶ã€çµæ´»çš„é—®é¢˜è§£å†³æ–¹å¼ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š

1. **è‡ªé€‚åº”æ€§å¼º**ï¼šèƒ½å¤Ÿæ ¹æ®ç¯å¢ƒå˜åŒ–åŠ¨æ€è°ƒæ•´ç­–ç•¥
2. **ä¿¡æ¯åˆ©ç”¨æ•ˆç‡é«˜**ï¼šæ¸è¿›å¼è·å–å’Œåˆ©ç”¨ä¿¡æ¯ï¼Œé¿å…ä¿¡æ¯è¿‡è½½
3. **å®¹é”™èƒ½åŠ›å¼º**ï¼šæ”¯æŒè¯•é”™å’Œä»é”™è¯¯ä¸­å­¦ä¹ 
4. **é€šç”¨æ€§å¥½**ï¼šé€‚ç”¨äºå¤šç§ç±»å‹çš„å¤æ‚ä»»åŠ¡

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒReActæ¨¡å¼ç‰¹åˆ«é€‚åˆå¤„ç†æ¢ç´¢æ€§ã€äº¤äº’æ€§å’Œä¸ç¡®å®šæ€§è¾ƒé«˜çš„ä»»åŠ¡ã€‚é€šè¿‡åˆç†çš„ä¼˜åŒ–ç­–ç•¥å’Œå·¥ç¨‹å®è·µï¼Œå¯ä»¥æ„å»ºå‡ºé«˜æ•ˆã€å¯é çš„ReActæ™ºèƒ½ä½“ç³»ç»Ÿã€‚

## æ‰©å±•é˜…è¯»

1. Yao, S., et al. (2022). "ReAct: Synergizing Reasoning and Acting in Language Models". arXiv preprint arXiv:2210.03629
2. Schick, T., et al. (2023). "Toolformer: Language Models Can Teach Themselves to Use Tools"
3. Simon, H. A. (1996). "The Sciences of the Artificial" - æœ‰ç•Œç†æ€§ç†è®ºåŸºç¡€
4. SchÃ¶n, D. A. (1983). "The Reflective Practitioner" - åæ€æ€§å®è·µç†è®º

## å®è·µé¡¹ç›®

1. **æ„å»ºReActç ”ç©¶åŠ©æ‰‹**ï¼šå®ç°ä¸€ä¸ªèƒ½å¤Ÿè‡ªä¸»æœç´¢ã€åˆ†æå’Œæ•´åˆä¿¡æ¯çš„ç ”ç©¶åŠ©æ‰‹
2. **å¼€å‘æ•…éšœè¯Šæ–­ç³»ç»Ÿ**ï¼šä½¿ç”¨ReActæ¨¡å¼æ„å»ºç³»ç»Ÿæ•…éšœçš„è‡ªåŠ¨è¯Šæ–­å·¥å…·
3. **è®¾è®¡äº¤äº’å¼é—®ç­”ç³»ç»Ÿ**ï¼šåˆ›å»ºæ”¯æŒå¤šè½®äº¤äº’å’Œç­–ç•¥è°ƒæ•´çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿ
4. **å®ç°æ¢ç´¢å¼æ•°æ®åˆ†æå·¥å…·**ï¼šæ„å»ºèƒ½å¤Ÿè‡ªä¸»æ¢ç´¢æ•°æ®æ¨¡å¼å’Œæ´å¯Ÿçš„åˆ†æç³»ç»Ÿ
