# OpenHands 提示词分类说明

## 快速导航

### 🤖 想了解智能体的核心行为？
→ 查看 **1-Agents** 文件夹

### 🔗 想了解如何与 GitHub/GitLab 等平台集成？
→ 查看 **2-Integrations** 文件夹

### 🔧 想了解如何自动解决代码问题？
→ 查看 **3-Resolver** 文件夹

### 📊 想了解如何评估系统性能？
→ 查看 **4-Benchmarks** 文件夹

### ⚙️ 想了解各种专门用途的微代理？
→ 查看 **5-Microagents** 文件夹

### 🏢 想了解企业版功能？
→ 查看 **6-Enterprise** 文件夹

---

## 详细分类

### 1️⃣ Agents - 智能体核心提示词

#### CodeAct Agent（代码执行智能体）
最强大的智能体，可以执行命令、修改代码、解决技术问题。

**核心提示词**：
- `system_prompt.j2` - 基础系统提示词（114行）
  - 定义角色和能力
  - 效率指南（合并操作、减少重复）
  - 文件系统操作规范
  - 代码质量标准
  - 版本控制最佳实践
  - 问题解决工作流
  - 安全性指南

**变体提示词**：
- `system_prompt_interactive.j2` - 交互模式（14行）
  - 增加用户交互规则
  - 澄清需求的策略

- `system_prompt_long_horizon.j2` - 长期任务模式（46行）
  - 任务追踪工具使用指南
  - 任务管理最佳实践
  - 任务持久化策略

- `system_prompt_tech_philosophy.j2` - 技术哲学模式（122行）
  - 采用 Linus Torvalds 的工程思维
  - 强调数据结构优先
  - 消除特殊情况
  - 向后兼容性原则
  - 实用主义哲学

**辅助模板**：
- `security_risk_assessment.j2` - 安全风险评估（LOW/MEDIUM/HIGH）
- `in_context_learning_example.j2` - 示例学习（Flask 应用示例）
- `additional_info.j2` - 运行时信息注入
- `microagent_info.j2` - 微代理信息注入

#### ReadOnly Agent（只读智能体）
专注于代码分析和探索，不能修改文件。

**核心提示词**：
- `system_prompt.j2` - 只读模式系统提示词（34行）
  - 明确只读能力范围
  - 代码分析指南
  - 限制说明

**辅助模板**：
- `in_context_learning_example.j2` - 只读模式示例（TypeScript 文件查找）
- `additional_info.j2` - 运行时信息
- `microagent_info.j2` - 微代理信息

---

### 2️⃣ Integrations - 集成服务提示词

各种代码托管平台和项目管理工具的集成提示词。

#### GitHub 集成
- `issue_prompt.j2` - 处理 GitHub Issue 的提示词
- `issue_conversation_instructions.j2` - Issue 对话规则
- `pr_update_prompt.j2` - 更新 Pull Request 的提示词
- `pr_update_conversation_instructions.j2` - PR 更新对话规则

#### GitLab 集成
- `issue_prompt.j2` - 处理 GitLab Issue
- `issue_conversation_instructions.j2` - Issue 对话规则
- `mr_update_prompt.j2` - 更新 Merge Request
- `mr_update_conversation_instructions.j2` - MR 更新对话规则

#### Bitbucket 集成
- `issue_prompt.j2` - 处理 Bitbucket Issue
- `issue_conversation_instructions.j2` - Issue 对话规则
- `pr_update_prompt.j2` - 更新 Pull Request
- `pr_update_conversation_instructions.j2` - PR 更新对话规则

#### Jira 集成
- `jira_instructions.j2` - Jira 平台操作指令
- `jira_new_conversation.j2` - 新建 Jira Issue 的对话模板
- `jira_existing_conversation.j2` - 处理已有 Jira Issue 的对话模板

#### Jira DC (Data Center) 集成
- `jira_dc_instructions.j2` - Jira DC 操作指令
- `jira_dc_new_conversation.j2` - 新建对话模板
- `jira_dc_existing_conversation.j2` - 已有对话模板

#### Linear 集成
- `linear_instructions.j2` - Linear 项目管理工具指令
- `linear_new_conversation.j2` - 新建 Issue 对话模板
- `linear_existing_conversation.j2` - 已有 Issue 对话模板

#### Slack 集成
- `user_message_conversation_instructions.j2` - Slack 用户消息处理指令

#### Suggested Tasks（建议任务）
自动识别和建议需要处理的任务：
- `failing_checks_prompt.j2` - CI/CD 检查失败时的提示
- `merge_conflict_prompt.j2` - 合并冲突时的提示
- `open_issue_prompt.j2` - 有未解决 Issue 时的提示
- `unresolved_comments_prompt.j2` - 有未解决评论时的提示

#### 其他
- `summary_prompt.j2` - 生成总结的通用模板

---

### 3️⃣ Resolver - 问题解决器提示词

#### Resolve（解决问题）
自动解决 Issue 和 PR 问题的提示词：

- `basic.jinja` - 基础问题解决模板
- `basic-conversation-instructions.jinja` - 基础对话指令
- `basic-with-tests.jinja` - 包含测试的解决模板
- `basic-with-tests-conversation-instructions.jinja` - 测试相关对话指令
- `basic-followup.jinja` - 后续跟进模板
- `basic-followup-conversation-instructions.jinja` - 跟进对话指令
- `pr-changes-summary.jinja` - PR 变更总结模板

#### Guess Success（成功判断）
判断问题是否已成功解决：

- `issue-success-check.jinja` - 检查 Issue 是否已解决
- `pr-feedback-check.jinja` - 检查 PR 反馈是否满意
- `pr-review-check.jinja` - 检查 PR 审查状态
- `pr-thread-check.jinja` - 检查 PR 讨论线程状态

---

### 4️⃣ Benchmarks - 评估基准提示词

用于系统性能评估和测试的提示词。

#### SWE-Bench（软件工程基准测试）
- `swe_default.j2` - 默认 SWE-Bench 测试提示词
- `swe_gpt4.j2` - GPT-4 优化的提示词
- `swt.j2` - SWT 测试提示词

#### NoCode-Bench（无代码基准测试）
- `nc.j2` - NoCode-Bench 测试提示词

---

### 5️⃣ Microagents - 微代理指令文档

24 个专门用途的微代理 Markdown 文档，通过关键词触发。

#### 平台集成类
- `github.md` - GitHub 操作指南
- `gitlab.md` - GitLab 操作指南
- `bitbucket.md` - Bitbucket 操作指南

#### 开发工具类
- `docker.md` - Docker 容器操作指南
- `kubernetes.md` - Kubernetes 编排指南
- `npm.md` - NPM 包管理指南
- `ssh.md` - SSH 连接和操作指南
- `pdflatex.md` - PDF LaTeX 编译指南
- `swift-linux.md` - Swift on Linux 开发指南

#### 代码质量类
- `code-review.md` - 代码审查标准指南
- `codereview-roasted.md` - 严格代码审查指南（更高标准）
- `fix-py-line-too-long.md` - 修复 Python 行过长问题
- `security.md` - 安全最佳实践

#### 测试相关类
- `fix_test.md` - 修复测试问题指南
- `update_test.md` - 更新测试指南

#### PR/Issue 管理类
- `address_pr_comments.md` - 处理 PR 评论指南
- `update_pr_description.md` - 更新 PR 描述指南

#### 知识管理类
- `agent_memory.md` - 代理记忆系统使用指南
- `add_agent.md` - 添加新代理的指南
- `add_repo_inst.md` - 添加仓库级指令

#### 其他
- `default-tools.md` - 默认工具集说明
- `onboarding.md` - 新用户入门指南
- `flarglebargle.md` - 示例微代理
- `README.md` - 微代理系统说明

---

### 6️⃣ Enterprise - 企业版提示词

企业版专用功能的提示词。

#### Solvability（可解决性分析）
- `summary_system_message.j2` - 总结系统消息模板
- `summary_user_message.j2` - 总结用户消息模板

---

### 7️⃣ Others - 其他辅助提示词

#### 微代理生成器
- `generate_remember_prompt.j2` - 生成记忆提示词的模板

#### 运行时模板
- `Dockerfile.j2` - Docker 运行时环境模板

---

## 提示词设计模式

### 1. 模块化设计
许多提示词通过 `{% include %}` 引用其他模板：
```jinja
{% include "system_prompt.j2" %}
<ADDITIONAL_SECTION>
...
</ADDITIONAL_SECTION>
```

### 2. 条件渲染
根据上下文动态渲染内容：
```jinja
{% if repository_info %}
<REPOSITORY_INFO>
{{ repository_info.repo_name }}
</REPOSITORY_INFO>
{% endif %}
```

### 3. 循环注入
批量注入信息：
```jinja
{% for agent_info in triggered_agents %}
<EXTRA_INFO>
{{ agent_info.content }}
</EXTRA_INFO>
{% endfor %}
```

### 4. 分层结构
使用 XML 风格的标签组织内容：
```xml
<ROLE>角色定义</ROLE>
<EFFICIENCY>效率指南</EFFICIENCY>
<CODE_QUALITY>代码质量</CODE_QUALITY>
```

---

## 使用场景映射

| 你想做什么 | 应该看哪个提示词 |
|----------|----------------|
| 了解 AI 智能体的基本行为 | 1-Agents/CodeAct-Agent/system_prompt.j2 |
| 了解如何与 AI 交互 | 1-Agents/CodeAct-Agent/system_prompt_interactive.j2 |
| 了解 Linus Torvalds 的工程哲学 | 1-Agents/CodeAct-Agent/system_prompt_tech_philosophy.j2 |
| 只分析代码不修改 | 1-Agents/ReadOnly-Agent/ |
| GitHub Issue 自动处理 | 2-Integrations/GitHub/issue_prompt.j2 |
| PR 自动更新 | 2-Integrations/GitHub/pr_update_prompt.j2 |
| 自动修复 CI 失败 | 2-Integrations/Suggested-Tasks/failing_checks_prompt.j2 |
| 自动解决合并冲突 | 2-Integrations/Suggested-Tasks/merge_conflict_prompt.j2 |
| 自动解决 Issue | 3-Resolver/Resolve/basic.jinja |
| 判断问题是否解决 | 3-Resolver/Guess-Success/ |
| 性能基准测试 | 4-Benchmarks/ |
| Docker 相关操作 | 5-Microagents/docker.md |
| 代码审查标准 | 5-Microagents/code-review.md |
| 安全最佳实践 | 5-Microagents/security.md |

---

## 技术栈说明

### Jinja2 模板引擎
- **官方文档**: https://jinja.palletsprojects.com/
- **语法特性**:
  - 变量替换: `{{ variable }}`
  - 条件判断: `{% if condition %} ... {% endif %}`
  - 循环: `{% for item in items %} ... {% endfor %}`
  - 模板继承: `{% extends "base.j2" %}`
  - 模板包含: `{% include "other.j2" %}`

### 微代理触发机制
微代理通过关键词匹配触发，例如：
- 提到 "docker" → 注入 docker.md
- 提到 "github" → 注入 github.md
- 提到 "security" → 注入 security.md

---

## 统计数据

### 文件数量
- **.j2 模板**: 52 个
- **.jinja 模板**: 11 个
- **.md 文档**: 24 个
- **总计**: 87 个提示词文件

### 各分类占比
1. Agents: 16 个文件 (18.4%)
2. Integrations: 23 个文件 (26.4%)
3. Resolver: 11 个文件 (12.6%)
4. Benchmarks: 4 个文件 (4.6%)
5. Microagents: 24 个文件 (27.6%)
6. Enterprise: 2 个文件 (2.3%)
7. Others: 2 个文件 (2.3%)
8. 根目录文档: 2 个文件 (2.3%)

### 代码规模（估算）
- CodeAct Agent 系统提示词: ~114 行
- ReadOnly Agent 系统提示词: ~34 行
- 技术哲学模式: ~122 行
- 长期任务模式: ~46 行
- 各类集成模板: 平均 50-100 行

---

*最后更新: 2025-10-21*
*版本: 基于 OpenHands 主分支*

